<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MR7 WORLD - OFFICIAL</title>

<style>
*{margin:0;padding:0;box-sizing:border-box;}
body{
 font-family:Segoe UI, sans-serif;
 background:#111;
 color:#eee;
 text-align:center;
 padding:15px;
 overflow-x:hidden;
 transition:.4s;
}

/* BACKGROUND */
body::before{
 content:"";
 position:fixed;
 top:0;left:0;
 width:100%;height:100%;
 z-index:-2;
 background:linear-gradient(120deg,#0f0f0f,#003300,#000000,#001a00);
 background-size:400% 400%;
 animation:bgMove 10s infinite alternate;
 opacity:.25;
}
@keyframes bgMove{
 0%{background-position:0% 50%}
 50%{background-position:100% 50%}
 100%{background-position:0% 50%}
}

body.dark-mode{
 background:#111;
 color:#eee;
}

/* LIGHT MODE */
body.light-mode{
 background:#fff;
 color:#111;
}
body.light-mode #chat{
 background:#f5f5f5;
 color:#111;
}
body.light-mode .neon-inner{
 background:rgba(255,255,255,.8);
 color:#111;
}
body.light-mode .card{
 background:rgba(255,255,255,.9);
 color:#111;
}
body.light-mode .tttCell{
 background:#fff;
 color:green;
}

/* SCROLL BAR */
#scrollBar{
 position:fixed;
 top:0;left:0;
 height:5px;
 width:0%;
 background:lime;
 z-index:99999;
 box-shadow:0 0 15px lime;
}

/* LOADER */
#loader{
 position:fixed;
 top:0;left:0;
 width:100%;height:100%;
 background:#000;
 display:flex;
 justify-content:center;
 align-items:center;
 flex-direction:column;
 z-index:9999;
 color:white;
 font-size:22px;
}
.loader-circle{
 width:80px;height:80px;
 border:6px solid #444;
 border-top:6px solid lime;
 border-radius:50%;
 animation:spin 1s linear infinite;
 margin-bottom:15px;
}
#loadPercent{
 font-size:18px;
 margin-top:10px;
 color:lime;
 font-weight:bold;
}
@keyframes spin{
 0%{transform:rotate(0deg)}
 100%{transform:rotate(360deg)}
}

/* NOTIFICATION */
#notify{
 position:fixed;
 top:80px;
 right:15px;
 background:black;
 color:lime;
 padding:12px 18px;
 border-radius:15px;
 display:none;
 box-shadow:0 0 20px rgba(0,255,0,.6);
 z-index:99999;
 animation:pop .4s ease;
}
@keyframes pop{
 from{transform:scale(.9);opacity:.4}
 to{transform:scale(1);opacity:1}
}

/* DARK BUTTON */
.dark-toggle{
 position:fixed;
 top:15px;right:15px;
 background:green;
 color:white;
 border:none;
 padding:10px 18px;
 border-radius:30px;
 cursor:pointer;
 z-index:999;
 font-size:14px;
 transition:.3s;
}
.dark-toggle:hover{transform:scale(1.05);}

/* MENU */
.menu{
 position:fixed;
 top:15px;left:15px;
 font-size:30px;
 cursor:pointer;
 z-index:1000;
 user-select:none;
}
.menu-box{
 position:fixed;
 top:60px;left:15px;
 background:#222;
 padding:12px;
 border-radius:12px;
 display:none;
 box-shadow:0 0 20px rgba(0,255,0,.5);
 z-index:1000;
 max-height:80vh;
 overflow:auto;
}
.menu-box button{
 width:210px;
 margin:6px 0;
 padding:10px;
 border:none;
 border-radius:10px;
 background:#333;
 color:white;
 cursor:pointer;
 transition:.3s;
 font-size:15px;
}
.menu-box button:hover{
 background:green;
 transform:scale(1.05);
}

/* SECTIONS */
.section{
 display:none;
 animation:fadeIn .5s ease;
 padding:20px 10px;
}
.section.active{display:block;}
@keyframes fadeIn{
 from{opacity:0;transform:translateY(15px)}
 to{opacity:1;transform:translateY(0)}
}

/* NEON BOX */
.neon-box{
 max-width:520px;
 margin:20px auto;
 border-radius:20px;
 overflow:hidden;
 position:relative;
}
.neon-box::before{
 content:"";
 position:absolute;
 top:-2px;left:-2px;
 width:calc(100% + 4px);
 height:calc(100% + 4px);
 background:linear-gradient(90deg,lime,green,lime,cyan,lime);
 background-size:400% 400%;
 animation:neonMove 4s infinite linear;
 z-index:-1;
}
@keyframes neonMove{
 0%{background-position:0% 50%}
 50%{background-position:100% 50%}
 100%{background-position:0% 50%}
}
.neon-inner{
 background:rgba(0,0,0,.6);
 padding:18px;
 border-radius:20px;
}

/* BUTTON */
.btn{
 background:green;
 color:white;
 padding:12px;
 width:100%;
 border:none;
 border-radius:12px;
 cursor:pointer;
 margin-top:10px;
 font-size:16px;
 transition:.3s;
}
.btn:hover{
 transform:scale(1.03);
 box-shadow:0 0 20px lime;
}

/* YOUTUBE BUTTON */
.yt-button{
 background:red;
 color:white;
 padding:14px 40px;
 border:none;
 border-radius:50px;
 cursor:pointer;
 font-size:18px;
 margin-top:15px;
 transition:.3s;
}
.yt-button:hover{transform:scale(1.08);}

/* PROFILE */
.profile-pic{
 width:170px;
 height:170px;
 border-radius:50%;
 border:5px solid lime;
 box-shadow:0 0 25px lime;
 margin-top:15px;
 transition:.3s;
}
.profile-pic:hover{transform:scale(1.07);}

/* TITLE */
#typingTitle{
 font-size:30px;
 font-weight:bold;
 color:lime;
 text-shadow:0 0 10px rgba(0,255,0,.6);
 margin-top:15px;
}

/* INPUTS */
input,textarea{
 width:95%;
 padding:12px;
 margin-top:8px;
 border-radius:10px;
 border:1px solid #aaa;
 outline:none;
 font-size:15px;
}
input:focus,textarea:focus{
 border:1px solid lime;
 box-shadow:0 0 10px rgba(0,255,0,.6);
}

/* CHAT */
#chat{
 text-align:left;
 max-height:300px;
 overflow-y:auto;
 background:#222;
 border-radius:12px;
 padding:10px;
 margin-top:10px;
 border:1px solid #555;
 white-space:pre-line;
}
.user{
 background:#133a20;
 color:#00ff88;
 padding:8px;
 border-radius:10px;
 margin:6px 0;
}
.bot{
 background:#0e2b44;
 color:#6bbcff;
 padding:8px;
 border-radius:10px;
 margin:6px 0;
}
#typingAI{
 display:none;
 color:gray;
 font-style:italic;
 margin-top:8px;
}

/* GAME CANVAS */
canvas{
 background:black;
 border:3px solid lime;
 border-radius:12px;
 margin-top:15px;
 width:100%;
 max-width:400px;
 height:auto;
 touch-action:none;
}

/* TIC TAC TOE */
#tttBoard{
 display:grid;
 grid-template-columns:repeat(3,1fr);
 gap:8px;
 max-width:320px;
 margin:15px auto;
}
.tttCell{
 background:#111;
 border:2px solid lime;
 border-radius:10px;
 height:90px;
 font-size:40px;
 color:lime;
 display:flex;
 justify-content:center;
 align-items:center;
 cursor:pointer;
 transition:.2s;
 user-select:none;
}
.tttCell:hover{transform:scale(1.05);}

/* GAME ZONE CARDS */
.cards{
 display:flex;
 flex-wrap:wrap;
 justify-content:center;
 gap:15px;
 margin-top:15px;
}
.card{
 width:160px;
 padding:15px;
 border-radius:15px;
 background:rgba(0,0,0,.5);
 border:1px solid lime;
 color:white;
 box-shadow:0 0 15px rgba(0,255,0,.3);
 cursor:pointer;
 transition:.3s;
 user-select:none;
}
.card:hover{
 transform:translateY(-6px) scale(1.05);
 box-shadow:0 0 25px lime;
}

/* MOBILE SNAKE BUTTONS */
.snake-controls{
 display:flex;
 justify-content:center;
 align-items:center;
 flex-direction:column;
 gap:10px;
 margin-top:15px;
}
.snake-row{
 display:flex;
 gap:10px;
 justify-content:center;
}
.control-btn{
 width:70px;
 height:55px;
 border:none;
 border-radius:12px;
 background:#111;
 color:lime;
 border:2px solid lime;
 font-size:20px;
 cursor:pointer;
 transition:.2s;
}
.control-btn:active{
 transform:scale(0.95);
 background:green;
 color:white;
}

/* MOBILE */
@media(max-width:600px){
 #typingTitle{font-size:26px;}
 .menu-box button{width:200px;}
 .card{width:140px;}
 .tttCell{height:80px;font-size:36px;}
}
</style>
</head>

<body>

<div id="scrollBar"></div>

<div id="loader">
  <div class="loader-circle"></div>
  <div>Welcome to MR7 WORLD üî•</div>
  <div id="loadPercent">0%</div>
</div>

<div id="notify">üî• Ready!</div>

<div class="menu" onclick="toggleMenu()">‚ãÆ</div>
<div class="menu-box" id="menuBox">
 <button onclick="openPage('home')">üè† Home</button>
 <button onclick="openPage('login')">üîê Login</button>
 <button onclick="openPage('ai')">ü§ñ MR7 AI</button>
 <button onclick="openPage('calculator')">üßÆ Calculator</button>
 <button onclick="openPage('games')">üéÆ Game Zone</button>
 <button onclick="openPage('snake')">üêç Snake Game</button>
 <button onclick="openPage('tictactoe')">‚ùå‚≠ï Tic Tac Toe</button>
 <button onclick="openPage('race')">üèé Car Racing</button>
 <button onclick="openPage('contact')">üìû Contact</button>
</div>

<button class="dark-toggle" onclick="toggleDark()">üåô Mode</button>

<!-- HOME -->
<div id="home" class="section active">
<h1 id="typingTitle"></h1>
<h2>- MD -</h2>
<h3>- REHAN -</h3>

<a href="https://www.youtube.com/@MR7OFFICIAL777" target="_blank">
<button class="yt-button">SUBSCRIBE</button>
</a>

<p style="margin-top:10px;">üëÜüèª CLICK HERE ‚òùüèª</p>
<img src="rehan.png" class="profile-pic">

<div class="neon-box">
<div class="neon-inner">
<h2 style="color:lime;">üî• MR7 WORLD FEATURES</h2>
<p style="color:white;margin-top:10px;line-height:1.6;">
‚úÖ Smart Offline AI (ChatGPT Style) <br>
‚úÖ Login System <br>
‚úÖ Calculator Mode <br>
‚úÖ Game Zone (Snake + TicTacToe + Racing) <br>
‚úÖ Mobile Responsive Pro UI <br>
</p>
</div>
</div>
</div>

<!-- LOGIN -->
<div id="login" class="section">
<div class="neon-box">
<div class="neon-inner">
<h2 style="color:lime;">üîê MR7 Login System</h2>
<input id="loginUser" placeholder="Enter Username">
<input id="loginPass" type="password" placeholder="Enter Password">
<button class="btn" onclick="doLogin()">Login</button>
<button class="btn" onclick="doLogout()">Logout</button>
<p id="loginStatus" style="margin-top:10px;color:lime;font-weight:bold;"></p>
</div>
</div>
</div>

<!-- AI -->
<div id="ai" class="section">
<div class="neon-box">
<div class="neon-inner">
<h2 style="color:lime;">ü§ñ MR7 AI PRO (Offline)</h2>

<div id="chat"></div>
<div id="typingAI">AI typing...</div>

<input id="aiInput" placeholder="Ask anything... (Hindi/English)">
<button class="btn" onclick="askAI()">Send</button>
<button class="btn" onclick="clearChat()">Clear Chat</button>
<button class="btn" onclick="downloadChat()">Download Chat</button>

</div>
</div>
</div>

<!-- CALCULATOR -->
<div id="calculator" class="section">
<div class="neon-box">
<div class="neon-inner">
<h2 style="color:lime;">üßÆ MR7 Calculator Mode</h2>
<input id="calcInput" placeholder="Example: 25+10*2">
<button class="btn" onclick="calculate()">Calculate</button>
<h3 id="calcResult" style="margin-top:10px;color:lime;"></h3>
</div>
</div>
</div>

<!-- GAME ZONE -->
<div id="games" class="section">
<div class="neon-box">
<div class="neon-inner">
<h2 style="color:lime;">üéÆ MR7 GAME ZONE</h2>
<p style="color:white;margin-top:8px;">Choose a game and enjoy üòéüî•</p>

<div class="cards">
  <div class="card" onclick="openPage('snake')">üêç Snake</div>
  <div class="card" onclick="openPage('tictactoe')">‚ùå‚≠ï Tic Tac Toe</div>
  <div class="card" onclick="openPage('race')">üèé Car Racing</div>
</div>

</div>
</div>
</div>

<!-- SNAKE GAME -->
<div id="snake" class="section">
<div class="neon-box">
<div class="neon-inner">
<h2 style="color:lime;">üêç Snake Game (Mobile Fixed)</h2>

<canvas id="snakeCanvas" width="400" height="400"></canvas>

<button class="btn" onclick="startSnake()">‚ñ∂ Start</button>
<button class="btn" onclick="pauseSnake()">‚è∏ Pause</button>
<button class="btn" onclick="resetSnake()">üîÑ Reset</button>

<h3 id="snakeScore" style="margin-top:10px;color:lime;">Score: 0</h3>

<div class="snake-controls">
  <div class="snake-row">
    <button class="control-btn" ontouchstart="setDir('up')" onclick="setDir('up')">‚¨Ü</button>
  </div>
  <div class="snake-row">
    <button class="control-btn" ontouchstart="setDir('left')" onclick="setDir('left')">‚¨Ö</button>
    <button class="control-btn" ontouchstart="setDir('down')" onclick="setDir('down')">‚¨á</button>
    <button class="control-btn" ontouchstart="setDir('right')" onclick="setDir('right')">‚û°</button>
  </div>
</div>

<p style="color:white;margin-top:10px;font-size:14px;">
üì± Mobile: Swipe or buttons <br>
‚å® PC: Arrow keys
</p>

</div>
</div>
</div>

<!-- TIC TAC TOE -->
<div id="tictactoe" class="section">
<div class="neon-box">
<div class="neon-inner">
<h2 style="color:lime;">‚ùå‚≠ï Tic Tac Toe</h2>
<div id="tttBoard"></div>
<h3 id="tttStatus" style="margin-top:10px;color:lime;">Player X Turn</h3>
<button class="btn" onclick="resetTTT()">üîÑ Reset</button>
</div>
</div>
</div>

<!-- CAR RACING -->
<div id="race" class="section">
<div class="neon-box">
<div class="neon-inner">
<h2 style="color:lime;">üèé Car Racing Mini</h2>

<canvas id="raceCanvas" width="400" height="500"></canvas>

<button class="btn" onclick="startRace()">‚ñ∂ Start Race</button>
<button class="btn" onclick="resetRace()">üîÑ Reset</button>

<h3 id="raceScore" style="margin-top:10px;color:lime;">Score: 0</h3>

<p style="color:white;font-size:14px;margin-top:8px;">
‚å® PC: Left / Right Arrow <br>
üì± Mobile: Tap buttons below
</p>

<div style="display:flex;gap:10px;justify-content:center;margin-top:12px;">
  <button class="btn" style="width:45%;" ontouchstart="moveLeft()" onclick="moveLeft()">‚¨Ö Left</button>
  <button class="btn" style="width:45%;" ontouchstart="moveRight()" onclick="moveRight()">Right ‚û°</button>
</div>

</div>
</div>
</div>

<!-- CONTACT -->
<div id="contact" class="section">
<div class="neon-box">
<div class="neon-inner">
<h2 style="color:lime;">üìû Contact Me</h2>
<input id="name" placeholder="Name">
<input id="mobile" placeholder="Mobile">
<textarea id="message" placeholder="Message"></textarea>
<button class="btn" onclick="sendMail()">Send Email</button>
</div>
</div>
</div>

<script>
/* =====================
   DARK MODE PERMANENT
===================== */
let theme = localStorage.getItem("mr7_theme");
if(!theme){
  theme="dark";
  localStorage.setItem("mr7_theme","dark");
}
applyTheme(theme);

function applyTheme(mode){
  document.body.classList.remove("dark-mode","light-mode");
  if(mode==="dark"){
    document.body.classList.add("dark-mode");
  }else{
    document.body.classList.add("light-mode");
  }
}

function toggleDark(){
  let current = localStorage.getItem("mr7_theme");
  if(current==="dark"){
    localStorage.setItem("mr7_theme","light");
    applyTheme("light");
    showNotification("‚òÄ Light Mode ON");
  }else{
    localStorage.setItem("mr7_theme","dark");
    applyTheme("dark");
    showNotification("üåô Dark Mode ON");
  }
}

/* =====================
   LOADER
===================== */
let percent=0;
let loadInt=setInterval(()=>{
 percent++;
 document.getElementById("loadPercent").innerText=percent+"%";
 if(percent>=100) clearInterval(loadInt);
},12);

window.onload=function(){
 setTimeout(()=>{
   document.getElementById("loader").style.display="none";
   showNotification("üî• MR7 WORLD Ready!");
   startTypingTitle();
 },1500);
};

/* =====================
   NOTIFY
===================== */
function showNotification(text){
 let notify=document.getElementById("notify");
 notify.innerText=text;
 notify.style.display="block";
 setTimeout(()=>{notify.style.display="none";},2500);
}

/* =====================
   TITLE
===================== */
function startTypingTitle(){
 let text="- MR7 WORLD -";
 let i=0;
 let typingTitle=document.getElementById("typingTitle");
 typingTitle.innerHTML="";
 let t=setInterval(()=>{
   typingTitle.innerHTML+=text.charAt(i);
   i++;
   if(i>=text.length) clearInterval(t);
 },120);
}

/* =====================
   SCROLL BAR
===================== */
window.onscroll=function(){
 let winScroll=document.documentElement.scrollTop || document.body.scrollTop;
 let height=document.documentElement.scrollHeight-document.documentElement.clientHeight;
 let scrolled=(winScroll/height)*100;
 document.getElementById("scrollBar").style.width=scrolled+"%";
}

/* =====================
   MENU
===================== */
function toggleMenu(){
 let menuBox=document.getElementById("menuBox");
 menuBox.style.display = menuBox.style.display=="block"?"none":"block";
}

/* =====================
   OPEN PAGE
===================== */
function openPage(id){
 document.querySelectorAll(".section").forEach(s=>s.classList.remove("active"));
 document.getElementById(id).classList.add("active");
 document.getElementById("menuBox").style.display="none";
 window.scrollTo({top:0,behavior:"smooth"});
}

/* =====================
   LOGIN SYSTEM
===================== */
function doLogin(){
 let u=document.getElementById("loginUser").value.trim();
 let p=document.getElementById("loginPass").value.trim();
 let loginStatus=document.getElementById("loginStatus");

 if(!u || !p){
   loginStatus.innerText="‚ö† Enter username and password!";
   return;
 }

 localStorage.mr7User=u;
 localStorage.mr7Pass=p;
 localStorage.loggedIn="yes";

 loginStatus.innerText="‚úÖ Login Successful! Welcome " + u;
 showNotification("üî• Welcome " + u);
}

function doLogout(){
 localStorage.loggedIn="no";
 document.getElementById("loginStatus").innerText="‚ùå Logged Out!";
 showNotification("Logout Successful!");
}

if(localStorage.loggedIn==="yes"){
 document.getElementById("loginStatus").innerText="‚úÖ Logged in as: " + localStorage.mr7User;
}

/* =====================
   AI PRO SYSTEM (OFFLINE)
===================== */
let chat=document.getElementById("chat");
chat.innerHTML = localStorage.chatHistory || "";

let aiMemory = JSON.parse(localStorage.aiMemory || "{}");
if(!aiMemory.mood) aiMemory.mood="normal";

function saveAIMemory(){
 localStorage.aiMemory = JSON.stringify(aiMemory);
}

function addMsg(text,cls){
 let div=document.createElement("div");
 div.className=cls;
 chat.appendChild(div);

 let i=0;
 let speed=10;

 let interval=setInterval(()=>{
   div.innerText = text.substring(0,i);
   i++;
   chat.scrollTop=chat.scrollHeight;
   if(i>text.length){
     clearInterval(interval);
     localStorage.chatHistory = chat.innerHTML;
   }
 },speed);
}

function detectMood(q){
 q=q.toLowerCase();

 if(q.includes("sad")||q.includes("depressed")||q.includes("tension")||q.includes("cry")){
   return "sad";
 }
 if(q.includes("angry")||q.includes("gussa")||q.includes("hate")){
   return "angry";
 }
 if(q.includes("happy")||q.includes("excited")||q.includes("mast")){
   return "happy";
 }
 return "normal";
}

function isMathExpression(text){
 return /^[0-9+\-*/().%\s]+$/.test(text);
}

function getAIReply(q){
 let original=q;
 let low=q.toLowerCase();

 // mood detect
 aiMemory.mood = detectMood(original);
 saveAIMemory();

 // name memory (better)
 if(low.includes("my name is")){
   let name = original.split("my name is")[1].trim();
   if(name.length>1){
     aiMemory.userName=name;
     saveAIMemory();
     return "üî• Nice! Ab main yaad rakhunga tumhara naam: " + name + " üòé";
   }
 }

 if(low.includes("mera naam")){
   let name = original.split("mera naam")[1].replace("hai","").trim();
   if(name.length>1){
     aiMemory.userName=name;
     saveAIMemory();
     return "üî• Wah Boss! Ab main yaad rakhunga tumhara naam: " + name + " üòé";
   }
 }

 let boss = aiMemory.userName ? aiMemory.userName : "Boss";

 // greeting
 if(low.includes("hello")||low.includes("hi")||low.includes("namaste")){
   return "Hello " + boss + " üòÑüî• MR7 WORLD me welcome!";
 }

 // mood reply
 if(aiMemory.mood==="sad"){
   return "üíö " + boss + ", tension mat lo. Tum strong ho üí™üî• MR7 WORLD always with you!";
 }
 if(aiMemory.mood==="angry"){
   return "üòÖ " + boss + ", gussa thoda kam karo. Chill karo bro üî•";
 }
 if(aiMemory.mood==="happy"){
   return "üòéüî• Wahh " + boss + "! Tumhara mood full OP lag raha hai!";
 }

 // common Q&A
 if(low.includes("how are you") || low.includes("kaise ho")){
   return "Main mast hoon " + boss + " üòéüî• Tum batao!";
 }

 if(low.includes("owner")||low.includes("malik")){
   return "Mera owner MD REHAN hai üòéüî• MR7 WORLD ka king!";
 }

 if(low.includes("time")){
   return "‚è∞ Time: " + new Date().toLocaleTimeString();
 }

 if(low.includes("date") || low.includes("day")){
   return "üìÖ Date: " + new Date().toLocaleDateString();
 }

 if(low.includes("game")){
   return "üéÆ MR7 GAME ZONE me Snake, TicTacToe aur Car Racing available hai üòéüî•";
 }

 // jokes improved
 if(low.includes("joke")){
   let jokes=[
     "üòÇ Teacher: Homework kiya? Student: Sir laptop hang ho gaya üò≠",
     "ü§£ Coding me bug fix karna life fix karne se easy hai!",
     "üòÇ Boss, tumhara future software developer pakka hai üòéüî•",
     "ü§£ Tumhari website dekh ke lagta hai hacker bhi subscribe karega üòÜ",
     "üòÇ MR7 AI: Main smart hoon... lekin tum aur smart ho üòé"
   ];
   return jokes[Math.floor(Math.random()*jokes.length)];
 }

 // motivation
 if(low.includes("motivate") || low.includes("motivation") || low.includes("inspire")){
   let mot=[
     "üî• " + boss + ", tu ek din top pe hoga! Bas rukna nahi üí™",
     "‚ö° Fail hona normal hai, give up karna galat hai!",
     "üèÜ Jo mehnat karta hai wahi legend banta hai üòé",
     "üöÄ Consistency = Success. Daily practice kar boss!",
     "üíØ Tumhara time aayega, aur duniya dekhegi MR7 WORLD!"
   ];
   return mot[Math.floor(Math.random()*mot.length)];
 }

 // calculator auto mode
 if(isMathExpression(low)){
   try{
     return "üßÆ Answer: " + eval(low);
   }catch{
     return "üòÖ Boss calculation samajh nahi aaya.";
   }
 }

 // memory recall
 if(low.includes("my name") && low.includes("what")){
   return aiMemory.userName ? ("üòé Tumhara naam " + aiMemory.userName + " hai!") : "üòÖ Tumne abhi naam nahi bataya.";
 }
 if(low.includes("mera naam kya hai")){
   return aiMemory.userName ? ("üòé Tumhara naam " + aiMemory.userName + " hai!") : "üòÖ Tumne abhi naam nahi bataya.";
 }

 // smart general answers
 if(low.includes("who are you") || low.includes("tum kaun ho")){
   return "Main MR7 AI PRO hoon ü§ñüî• Offline Smart AI, MD REHAN ke website ke liye!";
 }

 if(low.includes("help")){
   return "üòé " + boss + ", main help kar sakta hoon: Games, Calculator, Motivation, Jokes, Website tips aur basic answers!";
 }

 // default (no suggestion reply)
 let smartReplies=[
   "üòé " + boss + ", ye question interesting hai! Thoda aur detail me bolo.",
   "üî• Haan " + boss + ", ye possible hai. Tum daily practice karte raho!",
   "üí° Good question! Agar tum chaho to main ispe step-by-step explain kar dunga.",
   "‚ö° " + boss + ", main ready hoon! Next question bolo.",
   "ü§ñ " + boss + ", main offline AI hoon, lekin main smart reply dene ki try karta hoon üòÑ"
 ];
 return smartReplies[Math.floor(Math.random()*smartReplies.length)];
}

function askAI(){
 let input=document.getElementById("aiInput");
 let q=input.value.trim();
 if(!q) return;

 document.getElementById("typingAI").style.display="block";
 addMsg("You: "+q,"user");
 input.value="";

 setTimeout(()=>{
   document.getElementById("typingAI").style.display="none";
   let reply=getAIReply(q);
   addMsg("AI: "+reply,"bot");
 },700);
}

document.getElementById("aiInput").addEventListener("keypress",(e)=>{
 if(e.key==="Enter") askAI();
});

function clearChat(){
 if(confirm("Clear full chat?")){
   chat.innerHTML="";
   localStorage.removeItem("chatHistory");
 }
}

function downloadChat(){
 let text=chat.innerText;
 let blob=new Blob([text],{type:"text/plain"});
 let a=document.createElement("a");
 a.href=URL.createObjectURL(blob);
 a.download="MR7_AI_CHAT.txt";
 a.click();
}

/* =====================
   CALCULATOR MODE
===================== */
function calculate(){
 let exp=document.getElementById("calcInput").value.trim();
 let result=document.getElementById("calcResult");

 if(!exp){
   result.innerText="‚ö† Enter calculation!";
   return;
 }
 try{
   result.innerText="‚úÖ Result: " + eval(exp);
 }catch{
   result.innerText="‚ùå Invalid Expression!";
 }
}

/* =====================
   SNAKE GAME (MOBILE FIX)
===================== */
const snakeCanvas=document.getElementById("snakeCanvas");
const sctx=snakeCanvas.getContext("2d");

let snake,food,dir,snakeLoop,snakeScore=0,snakeRunning=false;

function initSnake(){
 snake=[{x:200,y:200}];
 dir={x:20,y:0};
 food=randomFood();
 snakeScore=0;
 updateSnakeScore();
 drawSnake();
}

function randomFood(){
 return {
   x:Math.floor(Math.random()*20)*20,
   y:Math.floor(Math.random()*20)*20
 };
}

function updateSnakeScore(){
 document.getElementById("snakeScore").innerText="Score: "+snakeScore;
}

function drawSnake(){
 sctx.clearRect(0,0,400,400);

 sctx.fillStyle="red";
 sctx.fillRect(food.x,food.y,20,20);

 sctx.fillStyle="lime";
 snake.forEach(p=>sctx.fillRect(p.x,p.y,20,20));
}

function updateSnake(){
 let head={x:snake[0].x+dir.x,y:snake[0].y+dir.y};

 if(head.x<0||head.y<0||head.x>=400||head.y>=400){
   snakeGameOver();
   return;
 }

 for(let i=1;i<snake.length;i++){
   if(head.x===snake[i].x && head.y===snake[i].y){
     snakeGameOver();
     return;
   }
 }

 snake.unshift(head);

 if(head.x===food.x && head.y===food.y){
   snakeScore++;
   updateSnakeScore();
   food=randomFood();
 }else{
   snake.pop();
 }

 drawSnake();
}

function snakeGameOver(){
 clearInterval(snakeLoop);
 snakeRunning=false;
 alert("Game Over üòÖ Score: "+snakeScore);
}

function startSnake(){
 if(snakeRunning) return;
 snakeRunning=true;
 snakeLoop=setInterval(updateSnake,120);
}

function pauseSnake(){
 clearInterval(snakeLoop);
 snakeRunning=false;
}

function resetSnake(){
 clearInterval(snakeLoop);
 snakeRunning=false;
 initSnake();
}

function setDir(d){
 if(d==="up" && dir.y===0) dir={x:0,y:-20};
 if(d==="down" && dir.y===0) dir={x:0,y:20};
 if(d==="left" && dir.x===0) dir={x:-20,y:0};
 if(d==="right" && dir.x===0) dir={x:20,y:0};
}

document.addEventListener("keydown",(e)=>{
 if(e.key==="ArrowUp") setDir("up");
 if(e.key==="ArrowDown") setDir("down");
 if(e.key==="ArrowLeft") setDir("left");
 if(e.key==="ArrowRight") setDir("right");
});

// swipe mobile
let touchStartX=0,touchStartY=0;

snakeCanvas.addEventListener("touchstart",(e)=>{
 let t=e.touches[0];
 touchStartX=t.clientX;
 touchStartY=t.clientY;
});

snakeCanvas.addEventListener("touchmove",(e)=>{
 e.preventDefault();
 let t=e.touches[0];
 let dx=t.clientX-touchStartX;
 let dy=t.clientY-touchStartY;

 if(Math.abs(dx)>Math.abs(dy)){
   if(dx>30) setDir("right");
   if(dx<-30) setDir("left");
 }else{
   if(dy>30) setDir("down");
   if(dy<-30) setDir("up");
 }
});

initSnake();

/* =====================
   TIC TAC TOE
===================== */
let board=["","","","","","","","",""];
let currentPlayer="X";
let gameOverTTT=false;

function createBoard(){
 let tttBoard=document.getElementById("tttBoard");
 tttBoard.innerHTML="";
 board.forEach((val,i)=>{
   let cell=document.createElement("div");
   cell.className="tttCell";
   cell.innerText=val;
   cell.onclick=()=>makeMove(i);
   tttBoard.appendChild(cell);
 });
}

function makeMove(i){
 if(board[i]!=="" || gameOverTTT) return;

 board[i]=currentPlayer;
 createBoard();

 if(checkWinner()){
   document.getElementById("tttStatus").innerText="üèÜ Player "+currentPlayer+" Wins!";
   gameOverTTT=true;
   return;
 }

 if(board.every(x=>x!=="")){
   document.getElementById("tttStatus").innerText="ü§ù Draw Match!";
   gameOverTTT=true;
   return;
 }

 currentPlayer = currentPlayer==="X"?"O":"X";
 document.getElementById("tttStatus").innerText="Player "+currentPlayer+" Turn";
}

function checkWinner(){
 let wins=[
   [0,1,2],[3,4,5],[6,7,8],
   [0,3,6],[1,4,7],[2,5,8],
   [0,4,8],[2,4,6]
 ];
 return wins.some(w=>{
   return board[w[0]] && board[w[0]]===board[w[1]] && board[w[1]]===board[w[2]];
 });
}

function resetTTT(){
 board=["","","","","","","","",""];
 currentPlayer="X";
 gameOverTTT=false;
 document.getElementById("tttStatus").innerText="Player X Turn";
 createBoard();
}

createBoard();

/* =====================
   CAR RACING GAME
===================== */
const raceCanvas=document.getElementById("raceCanvas");
const rctx=raceCanvas.getContext("2d");

let car={x:180,y:420,w:40,h:60};
let obstacles=[];
let raceScore=0;
let raceLoop;
let raceRunning=false;

function drawRace(){
 rctx.clearRect(0,0,400,500);

 rctx.fillStyle="#222";
 rctx.fillRect(0,0,400,500);

 // road lines
 rctx.strokeStyle="lime";
 rctx.lineWidth=2;
 rctx.strokeRect(5,5,390,490);

 rctx.fillStyle="lime";
 rctx.fillRect(car.x,car.y,car.w,car.h);

 rctx.fillStyle="red";
 obstacles.forEach(o=>{
   rctx.fillRect(o.x,o.y,o.w,o.h);
 });
}

function spawnObstacle(){
 let x=Math.floor(Math.random()*7)*55;
 obstacles.push({x:x,y:-60,w:50,h:60});
}

function updateRace(){
 if(Math.random()<0.06) spawnObstacle();

 obstacles.forEach(o=>o.y+=7);

 obstacles.forEach(o=>{
   if(car.x < o.x+o.w && car.x+car.w > o.x && car.y < o.y+o.h && car.y+car.h > o.y){
     endRace();
   }
 });

 obstacles = obstacles.filter(o=>o.y<520);

 raceScore++;
 document.getElementById("raceScore").innerText="Score: "+raceScore;

 drawRace();
}

function startRace(){
 if(raceRunning) return;
 raceRunning=true;
 raceLoop=setInterval(updateRace,50);
}

function resetRace(){
 clearInterval(raceLoop);
 raceRunning=false;
 obstacles=[];
 raceScore=0;
 car.x=180;
 document.getElementById("raceScore").innerText="Score: 0";
 drawRace();
}

function endRace(){
 clearInterval(raceLoop);
 raceRunning=false;
 alert("Crash üòÖ Score: "+raceScore);
}

function moveLeft(){
 car.x-=20;
 if(car.x<0) car.x=0;
}
function moveRight(){
 car.x+=20;
 if(car.x>360) car.x=360;
}

document.addEventListener("keydown",(e)=>{
 if(e.key==="ArrowLeft") moveLeft();
 if(e.key==="ArrowRight") moveRight();
});

drawRace();

/* =====================
   CONTACT EMAIL
===================== */
function sendMail(){
 let n=document.getElementById("name").value.trim();
 let m=document.getElementById("mobile").value.trim();
 let msg=document.getElementById("message").value.trim();

 if(!n || !msg){
   alert("Enter Name and Message üòÖ");
   return;
 }

 let subject=encodeURIComponent("MR7 Contact from "+n);
 let body=encodeURIComponent("Name: "+n+"\nMobile: "+m+"\n\nMessage:\n"+msg);

 location.href="mailto:mrrehanofficial.1777@gmail.com?subject="+subject+"&body="+body;
}
</script>

</body>
</html>
